      FUNCTION RANF()
      INTEGER IDUM,IM1,IM2,IMM1,IA1,IA2,IQ1,IQ2,IR1,IR2,NTAB,NDIV
      REAL RANF,AM,EPS,RNMX
      PARAMETER (IM1=2147483563,IM2=2147483399,AM=1./IM1,IMM1=Im1-1,
     *    IA1=40014,IA2=40692,IQ1=53668,IQ2=52774,IR1=12211,
     *    IR2=3791,NTAB=32,NDIV=1+IMM1/NTAB,EPS=1.2E-7,RNMX=1.-EPS)
*
      INTEGER IDUM2,J,K,IV,IY
*
      COMMON/RANDO/IDUM,IY,IDUM2,IV(NTAB)
*
      IF(IDUM.LE.0)THEN
      IDUM=MAX(-IDUM,1)
      IDUM2=IDUM
         DO 11 J=NTAB+8,1,-1
            K=IDUM/IQ1
            IDUM=IA1*(IDUM-K*IQ1)-K*IR1
            IF(IDUM.LT.0)IDUM=IDUM+IM1
            IF(J.LE.NTAB)IV(J)=IDUM
 11      CONTINUE
         IY=IV(1)
      END IF
      K=IDUM/IQ1
      IDUM=IA1*(IDUM-K*IQ1)-K*IR1
      IF(IDUM.LT.0)IDUM=IDUM+IM1
      K=IDUM2/IQ2
      IDUM2=IA2*(IDUM2-K*IQ2)-K*IR2
      IF(IDUM2.LT.0)IDUM2=IDUM2+IM2
      J=1+IY/NDIV
      IY=IV(J)-IDUM2
      IV(J)=IDUM
      IF(IY.LT.1)IY=IY+IMM1
      RANF=MIN(AM*IY,RNMX)
      RETURN
      END
      FUNCTION RANSET(IDUM2)
      INTEGER IDUM2
      RETURN
      END
      FUNCTION RANGET(IDUM2)
      INTEGER IDUM2
      RETURN
      END
