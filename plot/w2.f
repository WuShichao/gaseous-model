       IMPLICIT REAL*8(A-H,O-Z),INTEGER(I-K,M-N),LOGICAL(L)
C
       IREC=0
 1900  IREC=IREC+1
C
       READ(50,*,ERR=999,END=999)TIME,EPOT1,EKIN1,ETHR1,EBIN1
       READ(51,*,ERR=999,END=999)TIME,EPOT2,EKIN2,ETHR2,EBIN2
C
       ETOT1=EKIN1+ETHR1-EPOT1
       ETOT2=EKIN2+ETHR2-EPOT2
       IF(IREC.EQ.1)ETOT0=ETOT1+ETOT2
       EERR=ETOT0-ETOT1-ETOT2+EBIN1+EBIN2
       WRITE(52,100)TIME,-EPOT1,EKIN1,ETHR1,ETOT1,EERR,EBIN1
       WRITE(53,100)TIME,-EPOT2,EKIN2,ETHR2,ETOT2,EERR,EBIN2
C
 100   FORMAT(1X,1P,7(1X,D12.5))
C
       GOTO 1900
C
 999   PRINT*,IREC-1,' Records read and written '
       STOP
       END
